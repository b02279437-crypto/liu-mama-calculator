<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>LIU MAMA Order</title>

<!-- 字體 -->
<link href="https://fonts.googleapis.com/css2?family=Amatic+SC:wght@700&family=Noto+Serif+TC:wght@500;600&display=swap" rel="stylesheet">
<!-- 截圖功能 -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" defer></script>

<style>
:root{
  --milk:#E8D9C4;
  --navy:#1E4F7B;
  --bg:#f7f6f2;
  --gray-blue:#7f9bb3;
  --milk-solid:#e9e3d7;
}

/* ===== 全域樣式 ===== */
html,body{
  margin:0; padding:0; height:100%;
  background-color:var(--bg); color:#2c3e50;
  font-family:'Noto Serif TC','Microsoft JhengHei',serif;
  text-align:center; overflow-x:hidden;
}

/* ===== 開場動畫 ===== */
#intro{
  position:fixed; inset:0;
  background-color:var(--bg);
  display:flex; flex-direction:column;
  align-items:center; justify-content:flex-start;
  padding-top:20vh; z-index:9999;
  opacity:1; transition:opacity 1s ease;
  overflow:hidden;
}
#intro.fade-out{opacity:0; pointer-events:none;}

/* Logo */
#intro-logo{
  width:80vw; max-width:550px;
  opacity:0; transform:scale(0.98);
  transition:opacity 1.5s ease, transform 1.5s ease;
}
#intro-logo.show{opacity:1; transform:scale(1.03);}
#intro-logo.hide{opacity:0;}

/* ===== 霧氣動畫層 ===== */
#mist{
  position:absolute; inset:0;
  background: radial-gradient(circle at 50% 50%, rgba(210,210,210,0.35) 0%, rgba(255,255,255,0.7) 80%);
  filter: blur(40px);
  animation: mistFlow 14s ease-in-out infinite alternate;
  opacity:0; transition: opacity 2s ease;
}
@keyframes mistFlow{
  0%{transform:translate(-10px,0);}
  50%{transform:translate(20px,-10px);}
  100%{transform:translate(-15px,10px);}
}

/* ===== 文字霧中浮現 ===== */
#intro-text{
  font-size:15px; line-height:2.2; color:#333;
  opacity:0; white-space:pre-line; margin-top:40px;
  letter-spacing:.5px; transition:opacity 2s ease;
}
#intro-text.show{opacity:1;}
#intro-text span{
  opacity:0; filter:blur(5px);
  animation: fadeLetter 0.1s forwards;
}
@keyframes fadeLetter{to{opacity:1;filter:blur(0);}}

/* ===== 按鈕 ===== */
#startBtn{
  margin-top:60px; padding:14px 46px;
  font-size:30px; font-family:'Amatic SC',cursive;
  background-color:#ddd5c7; color:#2c3e50;
  border:none; border-radius:999px; cursor:pointer;
  box-shadow:0 3px 10px rgba(0,0,0,.08);
  opacity:0; transform:translateY(10px);
  transition:opacity .9s ease, transform .5s ease, background-color .3s ease;
}
#startBtn.show{opacity:1; transform:translateY(0);}
#startBtn:hover{background-color:#e7dfd2; transform:translateY(-2px);}

/* ===== 主內容淡入 ===== */
main{opacity:0; visibility:hidden; transition:opacity 1.2s ease;}
main.show{opacity:1; visibility:visible;}
.reveal{opacity:0; transform:translateY(30px); transition:all .8s;}
.reveal.in{opacity:1; transform:translateY(0);}
</style>
</head>

<body>
<!-- ===== 開場動畫 ===== -->
<div id="intro">
  <div id="mist"></div>
  <img id="intro-logo" src="https://github.com/b02279437-crypto/liu-mama-calculator/blob/main/logo.png?raw=true" alt="Logo">
  <div id="intro-text"></div>
  <button id="startBtn">Start Order</button>
  <!-- 火鍋滾聲 -->
  <audio id="boilSound" src="https://cdn.pixabay.com/download/audio/2022/10/12/audio_7a72f88f0e.mp3?filename=boiling-water-ambient-ambient-sound-124369.mp3" preload="auto"></audio>
</div>

<!-- ===== 主內容 ===== -->
<main id="mainContent">
  <h2>LIU MAMA Order</h2>
  <section class="reveal">
    <p>請填寫訂購人資訊</p>
    <label>訂購人姓名：</label><input type="text" id="customerName"><br><br>
    <label>訂購人電話：</label><input type="text" id="customerPhone" oninput="this.value=this.value.replace(/[^0-9]/g,'')">
  </section>

  <section class="reveal">
    <p>請選擇購買數量與寄送方式，系統將自動計算金額</p>
    <table border="1" style="margin:auto;">
      <tr><th>品項</th><th>價格</th><th>數量</th><th>小計</th></tr>
      <tr><td>麻辣底料包(2人份)</td><td>$320</td><td><select id="qty1" onchange="calculate()"></select></td><td id="sub1">$0</td></tr>
    </table><br>
    <table border="1" style="margin:auto;">
      <tr><th>寄送方式</th><th>價格</th><th>請勾選</th><th>小計</th></tr>
      <tr><td>711超商取貨</td><td>$60</td><td><input type="checkbox" id="ship711" onchange="selectShip('711')"></td><td id="sub711">$0</td></tr>
      <tr><td>郵局宅配</td><td>$120</td><td><input type="checkbox" id="shipPost" onchange="selectShip('post')"></td><td id="subPost">$0</td></tr>
    </table>
    <h3 id="total">總金額：$0</h3>
  </section>

  <section class="reveal">
    <h3>請匯款至以下帳戶:</h3>
    <p>台新銀行 812　帳號：<span id="accountNumber">123456789</span> 陳慧珍</p>
    <button onclick="copyAccount()">複製匯款帳號</button>
  </section>

  <section class="reveal">
    <button onclick="screenshotOrder()">截圖訂單</button>
    <button onclick="goToForm()">下一步,填寫寄送資訊</button>
    <p id="formReminder">煩請先匯款後,一定要按下一步填寫寄送資訊!</p>
  </section>
</main>

<script>
const textContent = `2015年，遠赴四川成都，
只為學習最正宗的麻辣鍋底與紅油煉製技術。

每一鍋湯底，皆由手工細火慢炒、用心成就，
香氣層層堆疊，滋味純粹真實。

為貼近台灣人的口味，我們精心調整湯與油的比例，
讓湯頭濃郁卻不膩口，香麻飽滿又溫潤順口。

嚴選13種中藥材、搭配多種乾辣椒與花椒，真材實料、
慢火細炒，熬製出一鍋「可以喝的麻辣湯底」。

讓你在家也能輕鬆享受純正的中藥香氣與濃厚麻辣，
無需繁瑣備料，一開煮就有火鍋店級的好味道。

劉嘛麻，一鍋來自初心的麻辣香氣，陪你溫暖每一餐。`;

window.addEventListener('DOMContentLoaded',()=>{
  const logo=document.getElementById('intro-logo');
  const mist=document.getElementById('mist');
  const text=document.getElementById('intro-text');
  const btn=document.getElementById('startBtn');
  const main=document.getElementById('mainContent');
  const intro=document.getElementById('intro');
  const boilSound=document.getElementById('boilSound');
  const qty=document.getElementById('qty1');

  for(let i=0;i<=35;i++){
    const o=document.createElement('option');
    o.value=i;o.textContent=i;qty.appendChild(o);
  }

  // LOGO 動畫
  setTimeout(()=>logo.classList.add('show'),300);
  setTimeout(()=>logo.classList.add('hide'),2500);
  setTimeout(()=>logo.style.display='none',3800);

  // 霧氣 + 文字
  setTimeout(()=>{
    mist.style.opacity=1;
    showFogText(textContent,text);
  },3500);

  // 按鈕出現
  setTimeout(()=>btn.classList.add('show'),8000);

  // 點擊 Start Order
  btn.addEventListener('click',()=>{
    // 開始火鍋滾聲
    boilSound.currentTime=0;
    boilSound.volume=0.25;
    boilSound.play().catch(()=>{});
    // 淡出開場
    intro.classList.add('fade-out');
    setTimeout(()=>{
      intro.style.display='none';
      main.classList.add('show');
      document.querySelectorAll('.reveal').forEach((el,i)=>setTimeout(()=>el.classList.add('in'),i*250));
    },800);
  });
});

function showFogText(text, container){
  container.innerHTML='';
  let delay=0;
  for(let char of text){
    if(char==='\n'){container.appendChild(document.createElement('br'));continue;}
    const span=document.createElement('span');
    span.textContent=char;
    span.style.animationDelay=delay+'s';
    container.appendChild(span);
    delay+=0.05;
  }
  container.classList.add('show');
}

/* === 表單功能 === */
function calculate(){
  const qty=parseInt(document.getElementById('qty1').value)||0;
  const c711=document.getElementById('ship711').checked;
  const cPost=document.getElementById('shipPost').checked;
  let ship=0;
  if(c711) ship=60;
  if(cPost) ship=120;
  document.getElementById('sub1').innerText='$'+(qty*320);
  document.getElementById('sub711').innerText=c711?'$60':'$0';
  document.getElementById('subPost').innerText=cPost?'$120':'$0';
  document.getElementById('total').innerText='總金額：$'+(qty*320+ship);
}
function selectShip(type){
  if(type==='711') document.getElementById('shipPost').checked=false;
  if(type==='post') document.getElementById('ship711').checked=false;
  calculate();
}
function copyAccount(){
  navigator.clipboard.writeText(document.getElementById('accountNumber').innerText);
  alert('匯款帳號已複製！');
}
function screenshotOrder(){
  html2canvas(document.getElementById('mainContent')).then(canvas=>{
    const link=document.createElement('a');
    link.href=canvas.toDataURL('image/png');
    link.download='liu_mama_order.png';
    link.click();
  });
}
function goToForm(){
  const name=document.getElementById('customerName').value.trim();
  const phone=document.getElementById('customerPhone').value.trim();
  const qty=parseInt(document.getElementById('qty1').value)||0;
  const ship711=document.getElementById('ship711').checked;
  const shipPost=document.getElementById('shipPost').checked;
  if(!name||!phone||qty<=0||(!ship711&&!shipPost)){
    alert('請完整填寫訂單資訊！'); return;
  }
  const ship=ship711?'711超商取貨':'郵局宅配';
  const total=qty*320+(ship711?60:120);
  const formUrl=`https://docs.google.com/forms/d/e/1FAIpQLScXsrY_3yROVmqR3sa-WecBs4y8wKeZuPLSM0QNgy602xEWJA/viewform?usp=pp_url`
  +`&entry.1152845848=${encodeURIComponent(name)}`
  +`&entry.178268335=${encodeURIComponent(phone)}`
  +`&entry.1732058404=${qty}`
  +`&entry.509305715=${encodeURIComponent(ship)}`
  +`&entry.1351577488=${total}`;
  window.open(formUrl,'_blank');
}
</script>
</body>
</html>
