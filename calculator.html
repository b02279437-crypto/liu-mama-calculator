<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>LIU MAMA Order</title>

<!-- 字體 -->
<link href="https://fonts.googleapis.com/css2?family=Amatic+SC:wght@700&family=Noto+Serif+TC:wght@500;600&display=swap" rel="stylesheet">
<!-- 截圖功能 -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" defer></script>

<!-- 預載圖片 -->
<link rel="preload" as="image" href="https://raw.githubusercontent.com/b02279437-crypto/liu-mama-calculator/main/logo.png">
<link rel="preload" as="image" href="https://raw.githubusercontent.com/b02279437-crypto/liu-mama-calculator/main/LOGO2-removebg-preview.png">

<style>
:root{
  --milk:#E8D9C4; 
  --navy:#1E4F7B; 
  --bg:#f7f6f2; 
  --gray-blue:#7f9bb3; 
  --milk-solid:#e9e3d7;
  --ease:cubic-bezier(.22,.61,.36,1);
  --ease-soft:cubic-bezier(.2,.7,.2,1);
  --t-fast:.24s; 
  --t-base:.6s; 
  --t-slow:1.2s;
  --control-h:44px;
  --qty-btn-w:36px;
  --qty-disp-w:56px;
  --crayon-blue:#54677C;
  --crayon-blue-ink:#3C5168;
}

html{-webkit-text-size-adjust:100%;}
*{ -webkit-tap-highlight-color: transparent; box-sizing:border-box; }
button{ touch-action: manipulation; }

/* ===== 全域 ===== */
html,body{
  margin:0; padding:0; height:100%;
  background-color:var(--bg); color:#2c3e50;
  font-family:'Noto Serif TC','Microsoft JhengHei',serif;
  text-align:center; overflow-x:hidden; scroll-behavior:smooth;
}

/* ===== 開場動畫 ===== */
#intro{
  position:fixed; inset:0; background-color:var(--bg);
  display:flex; flex-direction:column; align-items:center; justify-content:flex-start;
  padding-top:12vh; z-index:9999; opacity:1; transition:opacity var(--t-slow) var(--ease);
}
#intro.fade-out{opacity:0; pointer-events:none;}
#intro-logo{
  width:clamp(360px, 92vw, 700px);
  opacity:0; transform:scale(.99);
  transition:opacity calc(var(--t-slow)*1.1) var(--ease), transform calc(var(--t-slow)*1.3) var(--ease);
}
#intro-logo.show{opacity:1; transform:scale(1.04);}
#intro-logo.hide{opacity:0; transform:scale(1.04); transition:opacity var(--t-base) var(--ease);}
#intro-hero{
  width:clamp(260px,60vw,380px);
  opacity:0; transform:translateY(8px);
  transition:opacity var(--t-base) var(--ease), transform var(--t-base) var(--ease);
  margin:18px auto -72px; filter:drop-shadow(0 10px 14px rgba(0,0,0,0.15));
}
#intro-hero.show{opacity:1; transform:translateY(0);}
#intro-text{
  font-weight:500; color:#333; font-size:15px; line-height:1.9;
  opacity:0; white-space:pre-line; margin-top:-38px; letter-spacing:.5px;
  transition:opacity var(--t-base) var(--ease);
}
#intro-text.show{opacity:1;}

/* ===== Start Order（米白玻璃） ===== */
#startBtn{
  margin-top:16px;
  padding:12px 34px;
  font-size:26px;
  font-family:'Amatic SC',cursive;
  letter-spacing:2px;
  color:var(--navy);
  background:rgba(232,217,196,.85);
  border:1px solid rgba(210,190,160,.6);
  border-radius:999px;
  -webkit-backdrop-filter:blur(14px) saturate(1.06);
  backdrop-filter:blur(14px) saturate(1.06);
  box-shadow:inset 0 1px 0 rgba(255,255,255,.55), 0 10px 24px rgba(30,79,123,.12);
  cursor:pointer; position:relative; isolation:isolate;
  opacity:0; transform:translateY(10px);
  transition:opacity var(--t-base) var(--ease), transform var(--t-fast) var(--ease), filter .25s var(--ease);
}
#startBtn.show{opacity:1; transform:translateY(0);}
#startBtn:hover{ transform:translateY(-2px); filter:brightness(1.05);}
#startBtn:active{ transform:translateY(-1px);}
#startBtn::after{
  content:""; position:absolute; inset:auto; width:10px; height:10px; border-radius:50%;
  background:radial-gradient(circle, rgba(30,79,123,.18) 0%, rgba(30,79,123,0) 70%);
  transform:translate(-50%,-50%) scale(1); opacity:0; pointer-events:none;
}
#startBtn.rippling::after{ left:var(--rx); top:var(--ry); animation:rippleInk .8s var(--ease-soft); }
@keyframes rippleInk{0%{opacity:.35;transform:translate(-50%,-50%) scale(1);}100%{opacity:0;transform:translate(-50%,-50%) scale(35);}}

/* ===== 主內容 ===== */
main{opacity:0; visibility:hidden; transition:opacity var(--t-slow) var(--ease);}
main.show{opacity:1; visibility:visible;}
h2{
  font-size:90px; font-weight:900; color:#1E4F7B;
  margin:28px 0 10px 0; animation:titleFade 1.4s var(--ease) forwards;
}
@keyframes titleFade{0%{opacity:0; transform:translateY(12px) scale(.98);}60%{opacity:.8; transform:translateY(2px) scale(1.01);}100%{opacity:1; transform:translateY(0) scale(1);}}
h2 .english{font-family:'Amatic SC',cursive; font-weight:900;}
.reveal{opacity:0; transform:translateY(34px); transition:opacity .9s var(--ease), transform .9s var(--ease);}
.reveal.in{opacity:1; transform:translateY(0);}

/* ===== 表單與表格 ===== */
.input-container{max-width:500px;margin:0 auto 30px;text-align:left;background:#fff;padding:25px 28px;border-radius:16px;box-shadow:0 6px 22px rgba(0,0,0,.05);}
.input-group{display:flex;flex-direction:column;gap:5px;margin-bottom:18px;}
.input-group input{font-size:16px;height:var(--control-h);padding:0 12px;border:1px solid #ccc;border-radius:8px;background:#fafafa;}
.input-group input:focus{border-color:#1E4F7B;background:#fff;box-shadow:0 0 6px rgba(30,79,123,.2);}

/* 表格 */
table{width:90%;max-width:500px;margin:15px auto;border-collapse:separate;border-spacing:0;background:#fff;border-radius:16px;box-shadow:0 2px 10px rgba(0,0,0,.08);font-size:15px;text-align:center;}
th{background-color:var(--gray-blue);color:#fff;}
td,th{padding:10px;border-bottom:1px solid #e9eef2;white-space:nowrap;}
.col-price{width:90px;}
.col-action{width:148px;}
#qty1[hidden]{display:none !important;}

/* Stepper */
.qty-stepper{display:inline-flex;align-items:center;height:var(--control-h);border:1px solid #ccc;border-radius:8px;background:#fff;}
.qty-btn{width:var(--qty-btn-w);height:100%;border:none;background:#f3f3f3;cursor:pointer;font-size:20px;}
.qty-btn:hover{background:#ececec;}
.qty-input{width:var(--qty-disp-w);height:100%;border:none;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;text-align:center;font-size:16px;background:#fff;}

/* 寄送卡 */
.ship-wrap{width:90%;max-width:500px;margin:8px auto 12px;display:flex;gap:12px;}
.ship-card{flex:1;border-radius:14px;background:linear-gradient(180deg,rgba(255,255,255,.68),rgba(255,255,255,.50));backdrop-filter:blur(12px);border:1px solid rgba(255,255,255,.55);padding:14px 12px;cursor:pointer;transition:.3s;}
.ship-card:hover{transform:translateY(-1px);}
.ship-title,.ship-price{font-size:15px;color:#2d3b4a;}
.ship-title{font-weight:600;}
.ship-card input{position:absolute;opacity:0;}
.ship-card input:checked ~ .ship-title,.ship-card input:checked ~ .ship-price{color:#1E4F7B;}

/* 總額 */
.total{font-family:'Amatic SC',cursive;font-size:30px;font-weight:900;letter-spacing:2.5px;color:#1E4F7B;margin-top:16px;display:inline-block;opacity:0;transform:translateY(10px) scale(.96);transition:opacity var(--t-slow);}
.total.show{opacity:1;transform:translateY(0) scale(1);}
.total.animate{animation:totalUpdate .8s var(--ease);}
@keyframes totalUpdate{0%{transform:scale(1);}50%{transform:scale(1.04);}100%{transform:scale(1);}}

/* 匯款卡 */
.account-box{width:85%;max-width:350px;margin:25px auto 0;background:rgba(255,255,255,0.55);backdrop-filter:blur(12px);border:1px solid rgba(255,255,255,0.4);color:#333;padding:16px;border-radius:16px;font-size:13px;}
.account-box h3{margin:8px 0;font-weight:600;font-size:15px;color:#44566C;}

/* 按鈕 */
.btn{display:inline-flex;align-items:center;gap:8px;padding:12px 22px;border-radius:999px;font:600 15px 'Noto Serif TC','Microsoft JhengHei',serif;cursor:pointer;transition:transform .2s;}
.btn:hover{transform:translateY(-1px);}
.btn-crayon{color:#fff;background:var(--crayon-blue);border:1px solid var(--crayon-blue-ink);}
.btn-sketch{color:var(--navy);background:transparent;border:2px solid var(--navy);}

/* Toast */
.toast{position:fixed;left:50%;bottom:22px;transform:translateX(-50%) translateY(20px);min-width:260px;color:#1E4F7B;background:rgba(255,255,255,.75);border:1px solid rgba(30,79,123,.18);border-radius:12px;padding:12px 16px;font-size:14px;font-weight:600;backdrop-filter:blur(12px);opacity:0;transition:.5s;}
.toast.show{opacity:1;transform:translateX(-50%) translateY(0);}
</style>
</head>

<body>
<div id="intro">
  <img id="intro-logo" src="https://raw.githubusercontent.com/b02279437-crypto/liu-mama-calculator/main/logo.png" alt="Logo">
  <img id="intro-hero" src="https://raw.githubusercontent.com/b02279437-crypto/liu-mama-calculator/main/LOGO2-removebg-preview.png" alt="Hero">
  <div id="intro-text">
2015年遠赴四川成都，
學習正宗麻辣鍋底與紅油煉製。
手工慢炒堆疊香氣，濃郁而不膩。

劉嘛麻，一鍋來自初心的麻辣香氣，
陪你溫暖每一餐。
  </div>
  <button id="startBtn">Start Order</button>
</div>

<main id="mainContent">
  <h2><span class="english">LIU MAMA Order</span></h2>

  <section class="reveal">
    <p>請填寫訂購人資訊</p>
    <div class="input-container">
      <div class="input-group"><input type="text" id="customerName" placeholder="訂購人姓名"></div>
      <div class="input-group"><input type="text" id="customerPhone" placeholder="訂購人電話" maxlength="10"></div>
    </div>
  </section>

  <section class="reveal">
    <p>請選擇購買數量與寄送方式，系統將自動計算金額</p>
    <table id="productTable">
      <tr><th>品項</th><th>價格</th><th>數量</th></tr>
      <tr><td>麻辣底料包<br><small>(2人份)</small></td><td>$320</td>
      <td>
        <div class="qty-stepper">
          <button type="button" id="qtyMinus">−</button>
          <input id="qtyInput" type="text" value="0">
          <button type="button" id="qtyPlus">＋</button>
        </div>
        <select id="qty1" hidden></select>
      </td></tr>
    </table>
  </section>

  <section class="reveal">
    <div class="ship-wrap">
      <label class="ship-card"><input type="radio" name="shipMethod" value="711"><div class="ship-title">711超商取貨</div><div class="ship-price">$60</div></label>
      <label class="ship-card"><input type="radio" name="shipMethod" value="post"><div class="ship-title">郵局宅配</div><div class="ship-price">$120</div></label>
    </div>
    <div class="total" id="total">Total Amount: $0</div>
  </section>

  <section class="reveal">
    <div class="account-box">
      <h3>請匯款至以下帳戶:</h3>
      <p>台新銀行 812　帳號：<span id="accountNumber">123456789</span> 陳慧珍</p>
      <button class="btn btn-crayon" onclick="copyAccount()">複製匯款帳號</button>
    </div>
    <div style="display:flex;justify-content:center;gap:12px;margin-top:32px;">
      <button class="btn btn-sketch" onclick="screenshotOrder()">保存訂單截圖</button>
      <button class="btn btn-crayon" onclick="goToForm()">下一步：填寫寄送資訊</button>
    </div>
    <p id="formReminder">煩請先匯款後,一定要按下一步填寫寄送資訊!</p>
  </section>
</main>

<div id="toast" class="toast"></div>

<script>
function imgReady(el){return el.complete?Promise.resolve():new Promise(r=>{el.onload=r;el.onerror=r;});}
async function startIntroSequence(){
  const logo=document.getElementById('intro-logo'),hero=document.getElementById('intro-hero'),text=document.getElementById('intro-text'),btn=document.getElementById('startBtn');
  await Promise.race([Promise.all([imgReady(logo),imgReady(hero)]),new Promise(r=>setTimeout(r,4000))]);
  logo.classList.add('show');setTimeout(()=>logo.classList.add('hide'),2000);
  setTimeout(()=>{logo.style.display='none';hero.classList.add('show');text.classList.add('show');},3200);
  setTimeout(()=>btn.classList.add('show'),4800);
}
window.addEventListener('DOMContentLoaded',()=>{
  const s=document.getElementById('qty1');for(let i=0;i<=35;i++){const o=document.createElement('option');o.value=i;o.textContent=i;s.appendChild(o);}s.value="0";
  buildQty();calculate(true);startIntroSequence();
  const intro=document.getElementById('intro'),btn=document.getElementById('startBtn'),main=document.getElementById('mainContent');
  btn.addEventListener('click',e=>{triggerRipple(e);intro.classList.add('fade-out');setTimeout(()=>{intro.style.display='none';main.classList.add('show');document.querySelectorAll('.reveal').forEach((el,i)=>setTimeout(()=>el.classList.add('in'),i*180));setTimeout(()=>document.querySelector('.total').classList.add('show'),1000);setTimeout(()=>document.getElementById('formReminder').classList.add('in'),1100);},600);});
  document.querySelectorAll('.ship-card input').forEach(r=>r.addEventListener('change',()=>{calculate();document.querySelectorAll('.ship-card').forEach(c=>c.classList.toggle('selected',c.querySelector('input').checked));}));
});

function buildQty(){
  const MIN=0,MAX=35;
  const s=document.getElementById('qty1'),minus=document.getElementById('qtyMinus'),plus=document.getElementById('qtyPlus'),input=document.getElementById('qtyInput');
  const clamp=n=>Math.min(MAX,Math.max(MIN,Number(n)||0));
  function syncTo(v,t=true){v=clamp(v);s.value=v;input.value=v;if(t)calculate();}
  minus.onclick=()=>syncTo(+s.value-1); plus.onclick=()=>syncTo(+s.value+1);
  input.oninput=()=>{input.value=input.value.replace(/[^0-9]/g,'').slice(0,2);syncTo(input.value||0,true);}
  input.onblur=()=>syncTo(input.value||0,true);
  syncTo(s.value||0,false);
}
function triggerRipple(e){const b=e.currentTarget,r=b.getBoundingClientRect();b.style.setProperty('--rx',(e.clientX-r.left)+'px');b.style.setProperty('--ry',(e.clientY-r.top)+'px');b.classList.remove('rippling');void b.offsetWidth;b.classList.add('rippling');}
function showToast(m){const t=document.getElementById('toast');t.textContent=m;t.classList.add('show');clearTimeout(showToast._t);showToast._t=setTimeout(()=>t.classList.remove('show'),2200);}
let lastTotal=0;
function calculate(init){const qty=parseInt(document.getElementById('qty1').value)||0;let ship=0;const m=document.querySelector('input[name="shipMethod"]:checked');if(m)ship=m.value==='711'?60:120;const total=qty*320+ship;animateTotal(total,init);}
function animateTotal(target,isInit){const el=document.getElementById('total');if(isInit){lastTotal=target;el.textContent='Total Amount: $'+target;el.classList.add('show');return;}el.classList.remove('animate');void el.offsetWidth;el.classList.add('animate');const dur=900,t0=performance.now(),from=lastTotal,d=target-from;function f(now){const p=Math.min(1,(now-t0)/dur);const v=Math.round(from+d*(1-Math.pow(1-p,3)));el.textContent='Total Amount: $'+v;if(p<1)requestAnimationFrame(f);else lastTotal=target;}requestAnimationFrame(f);}
function copyAccount(){const acct=document.getElementById('accountNumber').innerText;navigator.clipboard.writeText(acct).then(()=>showToast('匯款帳號已複製，完成匯款後請按下一步填寫寄送資訊。'));}
function screenshotOrder(){html2canvas(document.getElementById('mainContent')).then(c=>{const l=document.createElement('a');l.href=c.toDataURL('image/png');l.download='liu_mama_order.png';l.click();showToast('截圖已下載！記得填寫表單喔。');});}
function goToForm(){const name=document.getElementById('customerName').value.trim(),phone=document.getElementById('customerPhone').value.trim(),qty=parseInt(document.getElementById('qty1').value)||0,m=document.querySelector('input[name="shipMethod"]:checked');if(!name||!phone||!m||qty<=0)return showToast('請完整填寫資訊');const ship=m.value==='711'?'711超商取貨':'郵局宅配';const total=qty*320+(m.value==='711'?60:120);const url=`https://docs.google.com/forms/d/e/1FAIpQLScXsrY_3yROVmqR3sa-WecBs4y8wKeZuPLSM0QNgy602xEWJA/viewform?usp=pp_url&entry.1152845848=${encodeURIComponent(name)}&entry.178268335=${encodeURIComponent(phone)}&entry.1732058404=${qty}&entry.509305715=${encodeURIComponent(ship)}&entry.1351577488=${total}`;window.open(url,'_blank');}
</script>
</body>
</html>
