<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>LIU MAMA Order</title>

<!-- 字體 -->
<link href="https://fonts.googleapis.com/css2?family=Amatic+SC:wght@700&family=Noto+Serif+TC:wght@500;600&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" defer></script>

<!-- 預載圖片 -->
<link rel="preload" as="image" href="https://raw.githubusercontent.com/b02279437-crypto/liu-mama-calculator/main/logo.png">
<link rel="preload" as="image" href="https://raw.githubusercontent.com/b02279437-crypto/liu-mama-calculator/main/LOGO2-removebg-preview.png">

<style>
:root{
  --milk:#E8D9C4; --navy:#1E4F7B; --bg:#f7f6f2; --gray-blue:#7f9bb3; --milk-solid:#e9e3d7;
  --ease:cubic-bezier(.22,.61,.36,1); --ease-soft:cubic-bezier(.2,.7,.2,1);
  --t-fast:.24s; --t-base:.6s; --t-slow:1.2s;
  --control-h:44px;
  --qty-btn-w:36px; --qty-disp-w:56px;
}

/* ===== 全域 ===== */
html,body{
  margin:0;padding:0;height:100%;
  background:var(--bg);color:#2c3e50;
  font-family:'Noto Serif TC','Microsoft JhengHei',serif;
  text-align:center;overflow-x:hidden;scroll-behavior:smooth;
}
button{touch-action:manipulation;-webkit-tap-highlight-color:transparent;}

/* ===== 開場動畫 ===== */
#intro{position:fixed;inset:0;background:var(--bg);display:flex;flex-direction:column;align-items:center;justify-content:flex-start;padding-top:14vh;z-index:9999;transition:opacity var(--t-slow) var(--ease);}
#intro.fade-out{opacity:0;pointer-events:none;}
#intro-logo{width:80vw;max-width:550px;opacity:0;transform:scale(.99);transition:opacity calc(var(--t-slow)*1.1),transform calc(var(--t-slow)*1.3);}
#intro-logo.show{opacity:1;transform:scale(1.03);}
#intro-logo.hide{opacity:0;}
#intro-hero{width:clamp(260px,60vw,380px);opacity:0;transform:translateY(8px);transition:opacity var(--t-base),transform var(--t-base);margin:18px auto -72px;filter:drop-shadow(0 10px 14px rgba(0,0,0,0.15));}
#intro-hero.show{opacity:1;transform:translateY(0);}
#intro-text{font-weight:500;color:#333;font-size:15px;line-height:1.9;opacity:0;white-space:pre-line;margin-top:-38px;transition:opacity var(--t-base);}
#intro-text.show{opacity:1;}
#startBtn{
  margin-top:14px;padding:14px 46px;font-size:30px;
  font-family:'Amatic SC',cursive;letter-spacing:2px;
  background-color:#ddd5c7;color:#2c3e50;border:none;border-radius:999px;cursor:pointer;
  box-shadow:0 3px 10px rgba(0,0,0,.08);
  opacity:0;transform:translateY(10px);
  transition:opacity var(--t-base),transform var(--t-fast),background-color .2s;
  position:relative;overflow:hidden;
}
#startBtn.show{opacity:1;transform:translateY(0);}
#startBtn:hover{background-color:#e7dfd2;transform:translateY(-2px);}
#startBtn::after{content:"";position:absolute;width:10px;height:10px;border-radius:50%;background:radial-gradient(circle,rgba(30,79,123,.18)0%,rgba(30,79,123,0)70%);transform:translate(-50%,-50%) scale(1);opacity:0;}
#startBtn.rippling::after{left:var(--rx);top:var(--ry);animation:rippleInk .8s var(--ease-soft);}
@keyframes rippleInk{0%{opacity:.35;transform:translate(-50%,-50%) scale(1);}100%{opacity:0;transform:translate(-50%,-50%) scale(35);}}

/* ===== 主內容 ===== */
main{opacity:0;visibility:hidden;transition:opacity var(--t-slow);}
main.show{opacity:1;visibility:visible;}
h2{font-size:90px;font-weight:900;color:#1E4F7B;margin:28px 0 10px;}
h2 .english{font-family:'Amatic SC',cursive;font-weight:900;}
.section-title{font-size:14px;color:#555;margin:10px 0 8px;}
.reveal{opacity:0;transform:translateY(34px);transition:opacity .9s var(--ease),transform .9s var(--ease);}
.reveal.in{opacity:1;transform:translateY(0);}

/* ===== 表格比例優化 ===== */
table{
  width:90%;max-width:500px;margin:15px auto;
  border-collapse:separate;border-spacing:0;
  background:#fff;border-radius:16px;overflow:hidden;
  box-shadow:0 2px 10px rgba(0,0,0,.08);
  font-size:15px;text-align:center;table-layout:fixed;
}
th,td{padding:10px;border-bottom:1px solid #e9eef2;vertical-align:middle;white-space:nowrap;}
th{background-color:var(--gray-blue);color:#fff;font-weight:500;}
.col-item{width:50%;}
.col-price{width:20%;}
.col-action{width:30%;}

/* ===== 高質感 Stepper ===== */
.qty-stepper{
  display:inline-flex;align-items:center;justify-content:center;
  height:42px;border-radius:10px;
  border:1px solid rgba(30,79,123,0.15);
  background:rgba(255,255,255,0.75);
  backdrop-filter:blur(6px) saturate(1.2);
  box-shadow:inset 0 1px 2px rgba(255,255,255,0.5),
              0 2px 8px rgba(30,79,123,0.1);
  transition:box-shadow .3s var(--ease),border-color .3s var(--ease);
}
.qty-stepper:hover{
  box-shadow:inset 0 1px 3px rgba(255,255,255,0.6),
              0 4px 16px rgba(30,79,123,0.18);
  border-color:rgba(30,79,123,0.25);
}
.qty-btn{
  width:34px;height:100%;border:none;
  background:linear-gradient(to bottom,#f9f9f9,#f1f1f1);
  font-size:18px;font-weight:600;color:#44566C;
  cursor:pointer;user-select:none;
  transition:all .25s var(--ease);
  border-radius:8px;
}
.qty-btn:hover{
  background:linear-gradient(to bottom,#ffffff,#f3f3f3);
  transform:translateY(-1px);
  box-shadow:0 2px 5px rgba(30,79,123,0.1);
}
.qty-btn:active{transform:translateY(0);background:#e6eaf0;}
.qty-input{
  width:56px;height:100%;border:none;
  border-left:1px solid rgba(30,79,123,0.1);
  border-right:1px solid rgba(30,79,123,0.1);
  text-align:center;font-family:'Noto Serif TC',serif;
  font-size:15px;font-weight:500;
  background:rgba(255,255,255,0.7);
  color:#1E4F7B;
  letter-spacing:.05em;
  transition:background-color .3s ease;
}
.qty-input:focus{background:#fff;outline:none;}
.qty-stepper:focus-within{
  box-shadow:0 0 0 4px rgba(30,79,123,0.12),
              inset 0 1px 4px rgba(255,255,255,0.6);
  border-color:rgba(30,79,123,0.25);
}

/* ===== 柔光總額 ===== */
.total{
  font-family:'Amatic SC',cursive;font-size:32px;font-weight:900;
  letter-spacing:2.8px;color:#1E4F7B;
  margin-top:18px;position:relative;display:inline-block;
  padding:6px 20px;opacity:0;transform:translateY(10px) scale(.96);
  transition:opacity var(--t-slow),transform var(--t-slow);
}
.total.show{opacity:1;transform:translateY(0) scale(1);}
.total::before{
  content:"";position:absolute;left:0;top:50%;width:100%;height:70%;
  transform:translateY(-50%) rotate(-1deg);
  background:linear-gradient(120deg,rgba(255,236,205,.9)0%,rgba(255,215,160,.7)100%);
  border-radius:14px;z-index:-1;
  filter:blur(1.6px)saturate(1.25)brightness(1.1);
  opacity:.75;mix-blend-mode:soft-light;
}
@keyframes totalUpdate{0%{transform:scale(1);}50%{transform:scale(1.05);}100%{transform:scale(1);}}
.total.animate{animation:totalUpdate .9s var(--ease);}
@keyframes glowPulse{
  0%{opacity:.6;filter:blur(1px)brightness(1);}
  50%{opacity:.9;filter:blur(2.3px)brightness(1.15);}
  100%{opacity:.7;filter:blur(1px)brightness(1);}
}
.total.glow::before{animation:glowPulse 1.8s var(--ease) 1;}

/* ===== 手機適配 ===== */
@media (max-width:480px){
  .col-item{width:58%;}
  .col-price{width:20%;}
  .col-action{width:22%;}
  .qty-stepper{height:38px;}
  .qty-btn{width:30px;font-size:16px;}
  .qty-input{width:46px;font-size:14px;}
  .total{font-size:28px;}
}
</style>
</head>

<body>
<div id="intro">
  <img id="intro-logo" src="https://raw.githubusercontent.com/b02279437-crypto/liu-mama-calculator/main/logo.png" alt="logo">
  <img id="intro-hero" src="https://raw.githubusercontent.com/b02279437-crypto/liu-mama-calculator/main/LOGO2-removebg-preview.png" alt="hero">
  <div id="intro-text">
2015年遠赴四川成都，
學習正宗麻辣鍋底與紅油煉製。
手工慢炒堆疊香氣，濃郁而不膩。

劉嘛麻，一鍋來自初心的麻辣香氣，
陪你溫暖每一餐。
  </div>
  <button id="startBtn">Start Order</button>
</div>

<main id="mainContent">
  <h2><span class="english">LIU MAMA Order</span></h2>

  <section class="reveal">
    <p class="section-title">請填寫訂購人資訊</p>
    <div class="input-container">
      <div class="input-group"><label>訂購人姓名</label><input id="customerName" type="text" placeholder="請輸入姓名"></div>
      <div class="input-group"><label>訂購人電話</label><input id="customerPhone" type="text" placeholder="請輸入電話" maxlength="10"></div>
    </div>
  </section>

  <section class="reveal">
    <p class="section-title">請選擇購買數量與寄送方式</p>
    <table id="productTable">
      <colgroup><col class="col-item"><col class="col-price"><col class="col-action"></colgroup>
      <tr><th>品項</th><th>價格</th><th>數量</th></tr>
      <tr>
        <td>麻辣底料包<br><small>(2人份)</small></td>
        <td>$320</td>
        <td>
          <div class="qty-stepper"><button id="qtyMinus">−</button><input id="qtyInput" type="text" value="0" maxlength="2"><button id="qtyPlus">＋</button></div>
          <select id="qty1" hidden></select>
        </td>
      </tr>
    </table>
  </section>

  <section class="reveal">
    <div class="ship-wrap">
      <label class="ship-card"><input type="radio" name="shipMethod" value="711"><div class="ship-title">711超商取貨</div><div class="ship-price">$60</div></label>
      <label class="ship-card"><input type="radio" name="shipMethod" value="post"><div class="ship-title">郵局宅配</div><div class="ship-price">$120</div></label>
    </div>
    <div class="total" id="total">Total Amount: $0</div>
  </section>
</main>

<script>
function imgReady(el){if(el.complete){if('decode' in el){return el.decode().catch(()=>{});}return Promise.resolve();}return new Promise(r=>{el.addEventListener('load',r,{once:true});el.addEventListener('error',r,{once:true});});}
async function startIntroSequence(){
  const logo=document.getElementById('intro-logo');
  const hero=document.getElementById('intro-hero');
  const text=document.getElementById('intro-text');
  const btn=document.getElementById('startBtn');
  const maxWait=new Promise(r=>setTimeout(r,4000));
  await Promise.race([Promise.all([imgReady(logo),imgReady(hero)]),maxWait]);
  requestAnimationFrame(()=>{
    logo.classList.add('show');
    setTimeout(()=>logo.classList.add('hide'),2000);
    setTimeout(()=>{logo.style.display='none';hero.classList.add('show');text.classList.add('show');},3200);
    setTimeout(()=>btn.classList.add('show'),4800);
  });
}
function triggerRipple(e){
  const btn=e.currentTarget,rect=btn.getBoundingClientRect();
  btn.style.setProperty('--rx',(e.clientX-rect.left)+'px');
  btn.style.setProperty('--ry',(e.clientY-rect.top)+'px');
  btn.classList.remove('rippling');void btn.offsetWidth;btn.classList.add('rippling');
}
window.addEventListener('DOMContentLoaded',()=>{
  const intro=document.getElementById('intro');
  const btn=document.getElementById('startBtn');
  const main=document.getElementById('mainContent');
  startIntroSequence();
  btn.addEventListener('click',(e)=>{
    triggerRipple(e);
    intro.classList.add('fade-out');
    setTimeout(()=>{intro.style.display='none';main.classList.add('show');},800);
  });
  buildQty();calculate();
});
function buildQty(){
  const select=document.getElementById('qty1');
  for(let i=0;i<=35;i++){const o=document.createElement('option');o.value=i;o.textContent=i;select.appendChild(o);}
  const minus=document.getElementById('qtyMinus'),plus=document.getElementById('qtyPlus'),input=document.getElementById('qtyInput');
  const clamp=n=>Math.min(35,Math.max(0,parseInt(n)||0));
  const sync=v=>{v=clamp(v);input.value=v;select.value=v;calculate();};
  minus.onclick=()=>sync(input.value-1);
  plus.onclick=()=>sync(input.value+1);
  input.oninput=()=>sync(input.value);
}
let lastTotal=0;
function calculate(){
  const qty=parseInt(document.getElementById('qty1').value)||0;
  const method=document.querySelector('input[name="shipMethod"]:checked');
  let ship=0;if(method){ship=(method.value==='711')?60:120;}
  const newTotal=qty*320+ship;
  animateTotal(newTotal);
}
function animateTotal(target){
  const el=document.getElementById('total');
  el.classList.remove('animate','glow');void el.offsetWidth;
  el.classList.add('animate','glow');
  el.textContent='Total Amount: $'+target;
}
</script>
</body>
</html>
