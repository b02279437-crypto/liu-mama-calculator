<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LIU MAMA Order</title>

<!-- 字體：標題用 Amatic SC、敘述用 Shippori Mincho B1（高級日系明朝風） -->
<link href="https://fonts.googleapis.com/css2?family=Amatic+SC:wght@700&family=Shippori+Mincho+B1:wght@600;700&display=swap" rel="stylesheet">
<!-- 截圖用 -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<style>
  :root{
    --bg-soft:#f7f6f2;
    --navy:#1e4f7b;
    --milk:#E8D9C4;
  }
  html,body{height:100%;}
  body{
    margin:0;
    background-color:var(--bg-soft);
    color:#2c3e50;
    font-family:'Noto Sans TC','Microsoft JhengHei',sans-serif;
    text-align:center;
    overflow-x:hidden;
  }

  /* ===== 開場動畫層 ===== */
  #intro{
    position:fixed; inset:0;
    background:#fff;
    display:flex; flex-direction:column; align-items:center; justify-content:center;
    z-index:9999;
  }
  #intro-logo{
    width:min(60vw,480px);
    max-width:85%;
    opacity:0; transition:opacity 1.5s ease;
  }
  #intro-logo.show{ opacity:1; }
  #intro-logo.hide{ opacity:0; transition:opacity 1.5s ease; }

  #intro-text{
    font-family:'Shippori Mincho B1', serif;
    font-weight:700; /* 加粗 */
    color:#333;
    font-size:20px;
    line-height:1.9;
    max-width:800px;
    padding:0 24px;
    margin:28px auto 0;
    white-space:pre-line;
    opacity:0; transition:opacity .5s ease;
  }
  #intro-text.show{ opacity:1; }

  #startBtn{
    margin-top:36px;
    padding:14px 44px;
    font-size:30px;
    font-family:'Amatic SC', cursive;
    letter-spacing:2px;
    background:var(--milk);
    color:var(--navy);
    border:none;
    border-radius:999px; /* 膠囊 */
    box-shadow:0 6px 16px rgba(0,0,0,.08);
    cursor:pointer;
    opacity:0; transform:translateY(6px);
    transition:opacity .6s ease, transform .3s ease, box-shadow .3s ease, filter .3s ease;
  }
  #startBtn.show{ opacity:1; transform:translateY(0); }
  #startBtn:hover{ filter:brightness(1.05); box-shadow:0 10px 22px rgba(0,0,0,.12); transform:translateY(-1px) scale(1.02); }

  /* 擦拭轉場（淡米灰） */
  #wipe{
    position:fixed; inset:0;
    background:var(--bg-soft);
    z-index:9998;
    transform:scaleX(0);
    transform-origin:center;
    transition:transform 1.1s ease-in-out;
    pointer-events:none;
  }
  #wipe.active{ transform:scaleX(1); }

  /* ===== 主內容（你的表單） ===== */
  main{ 
    visibility:hidden; opacity:0; 
    transition:opacity .8s ease .15s, visibility 0s linear .15s;
  }
  main.show{
    visibility:visible; opacity:1; transition-delay:0s;
  }

  /* 你原本的動畫 class（完全保留） */
  .fade-block{ opacity:0; transform:translateY(10px); transition:opacity .8s ease, transform .8s ease; }
  .fade-block.show{ opacity:1; transform:translateY(0); }

  .title-animate{ opacity:0; transform:scale(.5) translateX(-50px); transition:all 1s ease; }
  .title-animate.show{ opacity:1; transform:scale(1) translateX(0); }

  /* 你的原本樣式（不改動語意與顏色） */
  h2{
    font-size:90px;
    font-weight:900;
    color:var(--navy);
    margin:20px 0 10px 0;
  }
  h2 span.english{ font-family:'Amatic SC', cursive; font-weight:900; }

  p,.section-title{ font-size:14px; color:#555; text-align:center; margin-bottom:8px; }

  .input-container{ max-width:500px; margin:0 auto 15px; text-align:left; display:flex; flex-direction:column; gap:8px; }
  .input-group{ display:flex; align-items:center; }
  .input-group label{ width:120px; margin-right:8px; text-align:right; }
  #customerName{ width:120px; }
  #customerPhone{ width:180px; }
  .input-group input,.input-group select{
    height:28px; font-size:14px; padding:4px 8px; border:1px solid #b0bec5; border-radius:6px; transition:border-color .3s;
  }
  .input-error{ border-color:#e74c3c !important; }

  table{
    width:100%; max-width:500px; margin:15px auto; border-collapse:separate; border-spacing:0;
    background:#fff; border-radius:14px; overflow:hidden; box-shadow:0 2px 8px rgba(0,0,0,.1);
    font-size:16px; table-layout:fixed;
  }
  colgroup col:first-child{ width:45%; }
  colgroup col:nth-child(2){ width:15%; }
  colgroup col:nth-child(3){ width:20%; }
  colgroup col:nth-child(4){ width:20%; }
  th,td{ padding:10px; border-bottom:1px solid #dfe6e9; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
  th{ background-color:#7f9bb3; color:#fff; }
  input[type='checkbox']{ transform:scale(1.2); }
  .total{ font-size:20px; font-weight:bold; color:var(--navy); margin-top:20px; }

  .account-box{ width:80%; max-width:350px; margin:15px auto; background:#cfd2d4; color:#333; padding:10px; border-radius:10px; word-wrap:break-word; font-size:13px; }

  .copy-btn,#screenshotBtn,#formBtn{ border:none; padding:8px 16px; border-radius:12px; font-size:16px; cursor:pointer; font-weight:bold; }
  .copy-btn{ background-color:var(--navy); color:#fff; margin-top:8px; }
  #screenshotBtn{ background-color:#F4E0BE; color:#9e3520; }
  #formBtn{ background-color:#9e3520; color:#fff; }
  #buttonContainer{ display:flex; justify-content:center; gap:15px; flex-wrap:wrap; margin-top:20px; }
  .copy-btn:hover,#screenshotBtn:hover,#formBtn:hover{ opacity:.85; }
  #formReminder{ font-size:14px; color:#555; margin-top:10px; }

  @media (max-width:480px){
    h2{ font-size:60px; }
    table{ font-size:14px; }
    #screenshotBtn,#formBtn{ font-size:14px; padding:6px 12px; }
    .account-box{ font-size:12px; width:90%; max-width:300px; }
    #formReminder{ font-size:14px; }
    .input-container{ flex-direction:column; }
    .input-group{ flex-direction:column; align-items:flex-start; }
    .input-group label{ text-align:left; width:100%; margin-bottom:4px; }
  }
</style>
</head>
<body>

<!-- ====== 開場動畫層：LOGO -> 文字（打字機） -> 按鈕 ====== -->
<div id="intro" aria-hidden="false">
  <img id="intro-logo" src="https://github.com/b02279437-crypto/liu-mama-calculator/blob/main/logo.png?raw=true" alt="LIU MAMA Logo">
  <div id="intro-text"></div>
  <button id="startBtn" type="button">Start Order</button>
</div>
<div id="wipe" aria-hidden="true"></div>

<!-- ====== 主內容（你的表單，功能/樣式/動畫不變） ====== -->
<main id="mainContent" role="main" aria-live="polite">
  <h2 class="title-animate"><span class="english">LIU MAMA Order</span></h2>

  <p class="section-title fade-block">請填寫訂購人資訊</p>
  <div class="input-container fade-block">
    <div class="input-group">
      <label for="customerName">訂購人姓名:</label>
      <input type="text" id="customerName" placeholder="請輸入姓名">
    </div>
    <div class="input-group">
      <label for="customerPhone">訂購人電話:</label>
      <input type="text" id="customerPhone" placeholder="請輸入電話" oninput="this.value=this.value.replace(/[^0-9]/g,'')">
    </div>
  </div>

  <p class="section-title fade-block">請選擇購買數量與寄送方式，系統將自動計算金額</p>

  <div id="orderSection">
    <table class="fade-block" id="productTable">
      <colgroup><col><col><col><col></colgroup>
      <tr><th>品項</th><th>價格</th><th>數量</th><th>小計</th></tr>
      <tr>
        <td>麻辣底料包<br><small>(2人份)</small></td>
        <td>$320</td>
        <td>
          <select id="qty1" onchange="calculate()">
            <option value="0">0</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
          </select>
        </td>
        <td id="sub1">$0</td>
      </tr>
    </table>

    <table class="fade-block" id="shippingTable">
      <colgroup><col><col><col><col></colgroup>
      <tr><th>寄送方式</th><th>價格</th><th>請勾選</th><th>小計</th></tr>
      <tr>
        <td>711超商取貨</td>
        <td>$60</td>
        <td><input type="checkbox" id="ship711" onchange="selectShip('711')"></td>
        <td id="sub711">$0</td>
      </tr>
      <tr>
        <td>郵局宅配</td>
        <td>$120</td>
        <td><input type="checkbox" id="shipPost" onchange="selectShip('post')"></td>
        <td id="subPost">$0</td>
      </tr>
    </table>

    <div class="total fade-block" id="total">總金額：$0</div>

    <div class="account-box fade-block">
      <h3>請匯款至以下帳戶:</h3>
      <p>台新銀行 812　帳號：<span id="accountNumber">123456789</span> 陳慧珍</p>
      <button class="copy-btn" onclick="copyAccount()">複製匯款帳號</button>
    </div>
  </div>

  <div id="buttonContainer" class="fade-block">
    <button id="screenshotBtn" onclick="screenshotOrder()">截圖訂單</button>
    <button id="formBtn" onclick="goToForm()">下一步,填寫寄送資訊</button>
  </div>
  <p id="formReminder" class="fade-block">煩請先匯款後,一定要按下一步填寫寄送資訊!</p>
</main>

<script>
/* ===================== 開場動畫邏輯 ===================== */
const introTextContent = `2015年遠赴四川成都，學習正宗麻辣鍋底與紅油煉製。
每一鍋湯底，皆以手工慢炒堆疊香氣，濃郁而不膩。
嚴選十三味中藥材與多種花椒辣椒。
劉嘛麻，以初心熬香氣，溫暖每一餐。`;

window.addEventListener('DOMContentLoaded', () => {
  const intro = document.getElementById('intro');
  const logo = document.getElementById('intro-logo');
  const text = document.getElementById('intro-text');
  const btn = document.getElementById('startBtn');
  const wipe = document.getElementById('wipe');
  const main = document.getElementById('mainContent');

  // 1) LOGO：淡入 -> 停留 -> 淡出（節奏俐落）
  setTimeout(()=>logo.classList.add('show'), 100);          // 淡入 1.5s
  setTimeout(()=>logo.classList.add('hide'), 1800);         // 開始淡出
  // 2) 文字：顯示 + 打字機
  setTimeout(()=>{
    text.classList.add('show');
    typewriter(introTextContent, text, 38);                 // 速度可調
  }, 3400);
  // 3) 顯示 Start Order 按鈕
  setTimeout(()=>btn.classList.add('show'), 7600);

  // 4) 若 10 秒內沒按 → 自動進入
  const autoTimer = setTimeout(triggerEnter, 17600);

  btn.addEventListener('click', () => {
    clearTimeout(autoTimer);
    triggerEnter();
  });

  function triggerEnter(){
    // 擦拭轉場
    wipe.classList.add('active');
    // 擦拭到一半時切換內容（避免閃爍）
    setTimeout(()=>{
      intro.setAttribute('aria-hidden','true');
      intro.style.display='none';
      main.classList.add('show'); // 顯示主內容
      // 進來後啟動你原本的淡入動畫（逐塊show）
      startFormStagger();
    }, 600);
    // 擦拭結束後收起 wipe
    setTimeout(()=>{ wipe.classList.remove('active'); }, 1300);
  }

  function typewriter(str, el, speed){
    let i = 0;
    const timer = setInterval(()=>{
      el.textContent = str.slice(0, i++);
      if(i > str.length) clearInterval(timer);
    }, speed);
  }

  function startFormStagger(){
    // 標題進場
    const title = document.querySelector('h2.title-animate');
    if(title) setTimeout(()=>title.classList.add('show'), 150);

    // 依序顯示各區塊
    const showOrder = [
      '.section-title',
      '.input-container',
      '#productTable',
      '#shippingTable',
      '.total',
      '.account-box',
      '#buttonContainer',
      '#formReminder'
    ];
    showOrder.forEach((sel, idx)=>{
      const el = document.querySelector(sel);
      if(el){ setTimeout(()=>el.classList.add('show'), 350 + idx*220); }
    });

    // 表格列交錯淡入
    const rows = document.querySelectorAll('#productTable tr, #shippingTable tr');
    rows.forEach((tr, i)=>{
      tr.classList.add('fade-block');
      setTimeout(()=>tr.classList.add('show'), 520 + i*140);
    });
  }
});

/* ===================== 表單功能（完全保留） ===================== */
function calculate(){
  let qty1 = parseInt(document.getElementById('qty1').value)||0;
  document.getElementById('sub1').innerText = '$'+(qty1*320);
  let ship = 0;
  if(document.getElementById('ship711').checked) ship = 60;
  if(document.getElementById('shipPost').checked) ship = 120;
  document.getElementById('sub711').innerText = document.getElementById('ship711').checked?'$60':'$0';
  document.getElementById('subPost').innerText = document.getElementById('shipPost').checked?'$120':'$0';
  document.getElementById('total').innerText = '總金額：$'+(qty1*320+ship);
}
function selectShip(type){
  if(type==='711') document.getElementById('shipPost').checked=false;
  if(type==='post') document.getElementById('ship711').checked=false;
  calculate();
}
function copyAccount(){
  navigator.clipboard.writeText(document.getElementById('accountNumber').innerText);
  alert('匯款帳號已複製！記得匯款後，再按下前往填寫表單按鈕喔！');
}
function screenshotOrder(){
  html2canvas(document.getElementById('orderSection')).then(canvas=>{
    const link=document.createElement('a');
    link.href=canvas.toDataURL('image/png');
    link.download='liu_mama_order.png';
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    alert('截圖已下載！記得填寫表單喔！');
  });
}
function goToForm(){
  const name=document.getElementById('customerName').value.trim();
  const phone=document.getElementById('customerPhone').value.trim();
  const qty=parseInt(document.getElementById('qty1').value)||0;
  const ship711=document.getElementById('ship711').checked;
  const shipPost=document.getElementById('shipPost').checked;
  document.getElementById('customerName').classList.remove('input-error');
  document.getElementById('customerPhone').classList.remove('input-error');
  let err='';
  if(!name){ err+='請輸入訂購人姓名！\n'; document.getElementById('customerName').classList.add('input-error'); }
  if(!phone){ err+='請輸入訂購人電話！\n'; document.getElementById('customerPhone').classList.add('input-error'); }
  else if(!/^\d{10}$/.test(phone)){ err+='訂購人電話必須為10碼數字！\n'; document.getElementById('customerPhone').classList.add('input-error'); }
  if(qty<=0) err+='請選擇購買數量！\n';
  if(!ship711 && !shipPost) err+='請選擇寄送方式！';
  if(err){ alert('訂單填寫不完整:\n'+err); return; }
  const ship=ship711?'711超商取貨':'郵局宅配';
  const total=qty*320+(ship711?60:120);
  const formUrl=`https://docs.google.com/forms/d/e/1FAIpQLScXsrY_3yROVmqR3sa-WecBs4y8wKeZuPLSM0QNgy602xEWJA/viewform?usp=pp_url`+
                `&entry.1152845848=${encodeURIComponent(name)}`+
                `&entry.178268335=${encodeURIComponent(phone)}`+
                `&entry.1732058404=${qty}`+
                `&entry.509305715=${encodeURIComponent(ship)}`+
                `&entry.1351577488=${total}`;
  window.open(formUrl,'_blank');
}
</script>
</body>
</html>
